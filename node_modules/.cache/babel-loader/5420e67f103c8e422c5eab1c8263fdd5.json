{"ast":null,"code":"import axios from \"axios\";\n\nconst fetchPosts = async state => {\n  //Requesting posts via state's API parameters.\n  const offset = state.offset,\n        limit = state.limit,\n        post = state.post,\n        media = state.media;\n  axios({\n    method: \"get\",\n    url: \"https://api.slstice.com/mock/posts?offset=\".concat(offset, \"&limit=\").concat(limit, \"&api_key=ZkUvF7GBqc0l1Ou6DSPf\"),\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(async ({\n    data: {\n      response\n    }\n  }) => {\n    // Mapping the responses to request the /medias/ endpoint\n    const postArray = await Promise.all( // with the propper parameters, for every retrieved post.\n    response.posts.map(async post => {\n      const _ref = await axios({\n        method: \"get\",\n        url: \"https://api.slstice.com/mock/medias/\".concat(post.mediaId, \"?api_key=ZkUvF7GBqc0l1Ou6DSPf\"),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }),\n            media = _ref.data.response.media;\n\n      const _ref2 = await axios({\n        method: \"get\",\n        url: \"https://api.slstice.com/mock/users/\".concat(media.owner.username, \"?api_key=ZkUvF7GBqc0l1Ou6DSPf\"),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }),\n            user = _ref2.data.response.user;\n\n      media.user = user; // Saving freshly fetched media and user object into post's properties.\n\n      post.media = media;\n      return post;\n    })); // Assignation of the newly fetched array of posts to the component's state.\n    // If post is null, return this.setState({ posts: postArray }). Else concatenate old state with new posts.\n\n    return state.posts === null ? this.setState({\n      posts: postArray\n    }) : this.setState({\n      posts: [...state.posts, ...postArray]\n    });\n  });\n};\n\nexport default fetchPosts;","map":{"version":3,"sources":["/Users/joriscarol/DEV/api-carousel/src/fetchPosts.js"],"names":["axios","fetchPosts","state","offset","limit","post","media","method","url","headers","then","data","response","postArray","Promise","all","posts","map","mediaId","owner","username","user","setState"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,UAAU,GAAG,MAAOC,KAAP,IAAiB;AAClC;AADkC,QAE3BC,MAF2B,GAEGD,KAFH,CAE3BC,MAF2B;AAAA,QAEnBC,KAFmB,GAEGF,KAFH,CAEnBE,KAFmB;AAAA,QAEZC,IAFY,GAEGH,KAFH,CAEZG,IAFY;AAAA,QAENC,KAFM,GAEGJ,KAFH,CAENI,KAFM;AAIlCN,EAAAA,KAAK,CAAC;AACJO,IAAAA,MAAM,EAAE,KADJ;AAEJC,IAAAA,GAAG,sDAA+CL,MAA/C,oBAA+DC,KAA/D,kCAFC;AAGJK,IAAAA,OAAO,EAAE;AACP,sBAAgB;AADT;AAHL,GAAD,CAAL,CAMGC,IANH,CAMQ,OAAO;AAAEC,IAAAA,IAAI,EAAE;AAAEC,MAAAA;AAAF;AAAR,GAAP,KAAkC;AAAI;AAC1C,UAAMC,SAAS,GAAG,MAAMC,OAAO,CAACC,GAAR,EAAkB;AACxCH,IAAAA,QAAQ,CAACI,KAAT,CAAeC,GAAf,CAAmB,MAAMZ,IAAN,IAAc;AAAA,mBAK3B,MAAML,KAAK,CAAC;AACdO,QAAAA,MAAM,EAAE,KADM;AAEdC,QAAAA,GAAG,gDAAyCH,IAAI,CAACa,OAA9C,kCAFW;AAGdT,QAAAA,OAAO,EAAE;AACP,0BAAgB;AADT;AAHK,OAAD,CALgB;AAAA,YAGfH,KAHe,QAE7BK,IAF6B,CAG3BC,QAH2B,CAGfN,KAHe;;AAAA,oBAgB3B,MAAMN,KAAK,CAAC;AACdO,QAAAA,MAAM,EAAE,KADM;AAEdC,QAAAA,GAAG,+CAAwCF,KAAK,CAACa,KAAN,CAAYC,QAApD,kCAFW;AAGdX,QAAAA,OAAO,EAAE;AACP,0BAAgB;AADT;AAHK,OAAD,CAhBgB;AAAA,YAcfY,IAde,SAa7BV,IAb6B,CAc3BC,QAd2B,CAcfS,IAde;;AAuB/Bf,MAAAA,KAAK,CAACe,IAAN,GAAaA,IAAb,CAvB+B,CAuBX;;AACpBhB,MAAAA,IAAI,CAACC,KAAL,GAAaA,KAAb;AACA,aAAOD,IAAP;AACD,KA1BD,CADsB,CAAxB,CADsC,CA8BtC;AACA;;AACA,WAAOH,KAAK,CAACc,KAAN,KAAgB,IAAhB,GACH,KAAKM,QAAL,CAAc;AAAEN,MAAAA,KAAK,EAAEH;AAAT,KAAd,CADG,GAEH,KAAKS,QAAL,CAAc;AAAEN,MAAAA,KAAK,EAAE,CAAC,GAAGd,KAAK,CAACc,KAAV,EAAiB,GAAGH,SAApB;AAAT,KAAd,CAFJ;AAGD,GAzCH;AA0CD,CA9CD;;AAgDA,eAAeZ,UAAf","sourcesContent":["import axios from \"axios\";\n\nconst fetchPosts = async (state) => {\n  //Requesting posts via state's API parameters.\n  const {offset, limit, post, media} = state;\n  \n  axios({\n    method: \"get\",\n    url: `https://api.slstice.com/mock/posts?offset=${offset}&limit=${limit}&api_key=ZkUvF7GBqc0l1Ou6DSPf`,\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  }).then(async ({ data: { response } }) => {   // Mapping the responses to request the /medias/ endpoint\n      const postArray = await Promise.all(      // with the propper parameters, for every retrieved post.\n        response.posts.map(async post => {\n          const {\n            data: {\n              response: { media }\n            }\n          } = await axios({\n            method: \"get\",\n            url: `https://api.slstice.com/mock/medias/${post.mediaId}?api_key=ZkUvF7GBqc0l1Ou6DSPf`,\n            headers: {\n              \"Content-Type\": \"application/json\"\n            }\n          });\n          const {\n            data: {\n              response: { user }\n            }\n          } = await axios({\n            method: \"get\",\n            url: `https://api.slstice.com/mock/users/${media.owner.username}?api_key=ZkUvF7GBqc0l1Ou6DSPf`,\n            headers: {\n              \"Content-Type\": \"application/json\"\n            }\n          });\n          media.user = user;  // Saving freshly fetched media and user object into post's properties.\n          post.media = media;\n          return post;\n        })\n      );\n      // Assignation of the newly fetched array of posts to the component's state.\n      // If post is null, return this.setState({ posts: postArray }). Else concatenate old state with new posts.\n      return state.posts === null\n        ? this.setState({ posts: postArray })\n        : this.setState({ posts: [...state.posts, ...postArray] });\n    });\n}\n\nexport default fetchPosts;"]},"metadata":{},"sourceType":"module"}